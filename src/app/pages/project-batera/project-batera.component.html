<nb-card>
  <nb-card-body>
    <h5>Tasks | Mine (60 Days)</h5>
    <button nbButton class="mx-1" ghost shape="rectangle">
      <nb-icon icon="menu-outline" pack="eva"></nb-icon>
        Projects
    </button>
    <input nbInput id="search" class="search-input mx-3" placeholder="Search">
    <nb-select selected="1" class="mx-3">
      <nb-option value="1">Reposition</nb-option>
      <nb-option value="2">Plan</nb-option>
      <nb-option value="3">Evaluation</nb-option>
      <nb-option value="3">Finish</nb-option>
    </nb-select>

    <nb-select selected="1" class="mx-3">
      <nb-option value="1">Responsible</nb-option>
      <nb-option value="2">SS</nb-option>
    </nb-select>
         
        <table [nbTreeGrid]="dataSource" [nbSort]="dataSource" (sort)="updateSort($event)" equalColumnsWidth>
  
          <tr nbTreeGridHeaderRow *nbTreeGridHeaderRowDef="allColumns"></tr>
          <tr nbTreeGridRow *nbTreeGridRowDef="let row; columns: allColumns"></tr>
      
          <ng-container [nbTreeGridColumnDef]="customColumn">
              <th nbTreeGridHeaderCell [nbSortHeader]="getSortDirection(customColumn)" *nbTreeGridHeaderCellDef>
              {{customColumn}}
              </th>
              <td nbTreeGridCell *nbTreeGridCellDef="let row">
              <ngx-fs-icon [kind]="row.data.kind" [expanded]="row.expanded"></ngx-fs-icon>
              {{row.data[customColumn]}}
              </td>
          </ng-container>
      
          <ng-container *ngFor="let column of defaultColumns; let index = index" [nbTreeGridColumnDef]="column" [showOn]="getShowOn(index)">
              <th nbTreeGridHeaderCell [nbSortHeader]="getSortDirection(column)" *nbTreeGridHeaderCellDef>
              {{column}}
              </th>
              <td nbTreeGridCell *nbTreeGridCellDef="let row">
                {{row.data[column] || '-'}}
              </td>
          </ng-container>
      </table>
  </nb-card-body>
</nb-card>


<nb-card>
    <nb-card-body>
      <nb-card-header class="d-flex justify-content-between w-100" >
          <h5>Project List</h5>
          <button nbButton outline status="primary" (click)="addProjectDial()" >Add Project</button>
        </nb-card-header>

      <ngx-datatable [class]="'bootstrap'" [rows]="allProjectDatas" [scrollbarH]="true" [columnMode]="'force'" class="row" [rowHeight]="'auto'" default>
          <ngx-datatable-column [name]="'Project name'" prop="kapal">
            <ng-template let-row="row" ngx-datatable-cell-template let-rowIndex="rowIndex">
              <a class="text-primary text-decoration-none" 
              style="cursor: pointer;" 
              [routerLink]="['./sub-menu-project', row.id_proyek ,{p: row.published}]" 
              [data] = 'row'>{{row.kapal.nama_kapal}}-DD-{{row.tahun}}</a>
           </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column name="Shortcut" prop="">
            <ng-template let-row="row" ngx-datatable-cell-template>
              <nb-icon [ngStyle]="{'color': 'green'}" icon="plus-square-outline"></nb-icon>
              <nb-icon [ngStyle]="{'color': 'green'}" icon="trash-2-outline"></nb-icon>
              <nb-icon [ngStyle]="{'color': 'green'}" icon="book-outline"></nb-icon>
              <nb-icon [ngStyle]="{'color': 'green'}" icon="checkmark-square"></nb-icon>
              <nb-icon [ngStyle]="{'color': 'green'}" icon="archive-outline"></nb-icon>
            </ng-template>  
          </ngx-datatable-column>

          <ngx-datatable-column [name]="'Ship Management'" prop="kapal.owner.nama_lengkap"></ngx-datatable-column>
          
          <ngx-datatable-column [name]="'R'" width="30">
            <ng-template let-row="row" ngx-datatable-cell-template>
              <nb-icon [ngStyle]="{'color': row.phase[0] ? 'green' : 'red'}" [icon]="row.phase[0] ? 'checkmark-square-2-outline' : 'close-square-outline'">
              </nb-icon>
            </ng-template>  
          </ngx-datatable-column>
          
          <ngx-datatable-column [name]="'P'" width="30">
            <ng-template let-row="row" ngx-datatable-cell-template>
              <nb-icon [ngStyle]="{'color': row.phase[1] ? 'green' : 'red'}" [icon]="row.phase[1] ? 'checkmark-square-2-outline' : 'close-square-outline'">
              </nb-icon>
            </ng-template>  
          </ngx-datatable-column>
          
          <ngx-datatable-column [name]="'E'" width="30" >
            <ng-template let-row="row" ngx-datatable-cell-template>
              <nb-icon [ngStyle]="{'color': row.phase[2] ? 'green' : 'red'}" [icon]="row.phase[2] ? 'checkmark-square-2-outline' : 'close-square-outline'">
              </nb-icon>
            </ng-template>  
          </ngx-datatable-column>
          
          <ngx-datatable-column [name]="'F'" width="30" >
            <ng-template let-row="row" ngx-datatable-cell-template>
              <nb-icon [ngStyle]="{'color': row.phase[3] ? 'green' : 'red'}" [icon]="row.phase[3] ? 'checkmark-square-2-outline' : 'close-square-outline'">
              </nb-icon>
            </ng-template>  
          </ngx-datatable-column>

          <ngx-datatable-column [name]="'Start Date'" prop="off_hire_start">
            <ng-template let-row="row" ngx-datatable-cell-template>
              {{ row.created_at | date:'medium' }}
            </ng-template> 
          </ngx-datatable-column>

          <ngx-datatable-column [name]="'Last Change'" prop="updated_at">
            <ng-template let-row="row" ngx-datatable-cell-template>
              {{ row.updated_at | date:'medium' }}
            </ng-template> 
          </ngx-datatable-column>

          <ngx-datatable-column [name]="''" width="50">
            <ng-template let-row="row" ngx-datatable-cell-template let-rowIndex="rowIndex">
              <button nbButton size="small" ghost (click)="deleteProject(rowIndex)"
              nbPopover="Delete Project" nbPopoverTrigger="hover" nbPopoverPlacement="top">
                <nb-icon icon="trash-2-outline" status="danger"></nb-icon>
              </button>
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column [name]="''" width="50" prop="id_proyek">
            <ng-template let-row="row" ngx-datatable-cell-template let-rowIndex="rowIndex">
              <button nbButton size="small" ghost (click)="publishProject(row.id_proyek)"
              nbPopover="Publish Project" nbPopoverTrigger="hover" nbPopoverPlacement="top">
                <nb-icon icon="cloud-upload-outline" status="success"></nb-icon>
              </button>
            </ng-template>
          </ngx-datatable-column>

        </ngx-datatable>
      </nb-card-body>
    </nb-card>
    