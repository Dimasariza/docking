<nb-card>
    <h5 class="m-4">Tasks | Mine</h5>
    <div style="overflow: auto; width: 100%;">
      <div style="width: 1424px;">
        <table [nbTreeGrid]="dataSource" [nbSort]="dataSource" (sort)="updateSort($event)">
          <tr nbTreeGridHeaderRow *nbTreeGridHeaderRowDef="allColumns"></tr>
          <tr nbTreeGridRow *nbTreeGridRowDef="let row; columns: allColumns"></tr>

          <ng-container [nbTreeGridColumnDef]="'icon'">
            <th nbTreeGridHeaderCell  *nbTreeGridHeaderCellDef style="width: 80px;">Job No</th>
            <td nbTreeGridCell *nbTreeGridCellDef="let row">
              <ngx-fs-icon [kind]="row.data.kind" [expanded]="row.expanded">
              </ngx-fs-icon>
              {{row?.data?.jobNumber}}
            </td>
          </ng-container>

          <ng-container [nbTreeGridColumnDef]="'project'">
            <th nbTreeGridHeaderCell  *nbTreeGridHeaderCellDef style="width: 280px;">
              <nb-select size="small" placeholder="Project" class="w-100">
                <nb-option *ngFor="let project of project;let id = index;" [value]="project">{{project.name}}</nb-option>
              </nb-select>
            </th>
            <td nbTreeGridCell *nbTreeGridCellDef="let row">
              {{row?.data?.project}}
            </td>
          </ng-container>

          <ng-container [nbTreeGridColumnDef]="'status'" >
            <th nbTreeGridHeaderCell  *nbTreeGridHeaderCellDef>
              <nb-select size="small" placeholder="Status" class="w-100">
                <nb-option *ngFor="let stat of status;let id = index;" [value]="stat">{{stat}}</nb-option>
              </nb-select>
            </th>
            <td nbTreeGridCell *nbTreeGridCellDef="let row">
              {{row?.data?.status || '-'}}
            </td>
          </ng-container>

          <ng-container [nbTreeGridColumnDef]="'resp'" >
            <th nbTreeGridHeaderCell  *nbTreeGridHeaderCellDef>
              <nb-select size="small" placeholder="Responsible" class="w-100">
                <nb-option *ngFor="let value of responsible; let id = index;" [value]="value">{{value.username}}</nb-option>
              </nb-select>
            </th>
            <td nbTreeGridCell *nbTreeGridCellDef="let row">
              {{row?.data?.responsible.name}}
            </td>
          </ng-container>

          <ng-container [nbTreeGridColumnDef]="'due'">
            <th nbTreeGridHeaderCell  *nbTreeGridHeaderCellDef>Due</th>
            <td nbTreeGridCell *nbTreeGridCellDef="let row">
              {{row?.data?.end | date : 'medium'}}
            </td>
          </ng-container>

          <ng-container *ngFor="let column of columnContents; let index = index" [nbTreeGridColumnDef]="column" [showOn]="getShowOn(index)">
              <th nbTreeGridHeaderCell [nbSortHeader]="getSortDirection(column)" *nbTreeGridHeaderCellDef>
                {{columnHead[index]}}
              </th>
              <td nbTreeGridCell *nbTreeGridCellDef="let row">
                {{row.data[column] || '-'}}
              </td>
          </ng-container>
      </table>
      </div>
    </div>
</nb-card>


<nb-card>
    <nb-card-body>
      <nb-card-header class="d-flex justify-content-between w-100" >
          <h5>Project List</h5>
          <button nbButton outline size="small" status="primary" (click)="addProjectDial()" >Add Project</button>
        </nb-card-header>

      <ngx-datatable [class]="'bootstrap'" [rows]="projectDatas" [scrollbarH]="true" [columnMode]="'force'" class="row" [rowHeight]="'auto'" default>
          <ngx-datatable-column [name]="'Project name'" prop="kapal">
            <ng-template let-row="row" ngx-datatable-cell-template let-rowIndex="rowIndex">
              <a class="text-primary text-decoration-none" 
              style="cursor: pointer;" 
              [routerLink]="['./sub-menu-project', row.id_proyek]"
              [data] = 'row'>{{row.kapal.nama_kapal}}-DD-{{row.tahun}}</a>
           </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column name="Shortcut" width="220">
            <ng-template let-row="row" ngx-datatable-cell-template>
              <button *ngFor="let button of shortCut" class="mx-1" nbButton size="small" ghost (click)="clickAction(button.menu, row)" [nbPopover]="button.menu" nbPopoverTrigger="hover" nbPopoverPlacement="top">
                <nb-icon [icon]="button.icon" status="danger"></nb-icon>
              </button>
            </ng-template>  
          </ngx-datatable-column>

          <ngx-datatable-column [name]="'Ship Management'" prop="shipManagement">
            <ng-template let-row="row" ngx-datatable-cell-template>
              {{shipManagement}}
            </ng-template>
          </ngx-datatable-column>
          
          <ngx-datatable-column [name]="'R'" width="30">
            <ng-template let-row="row" ngx-datatable-cell-template>
              <nb-icon [ngStyle]="{'color': row.phase[0] ? 'green' : 'red'}" [icon]="row.phase[0] ? 'checkmark-square-2-outline' : 'close-square-outline'">
              </nb-icon>
            </ng-template>  
          </ngx-datatable-column>
          
          <ngx-datatable-column [name]="'P'" width="30">
            <ng-template let-row="row" ngx-datatable-cell-template>
              <nb-icon [ngStyle]="{'color': row.phase[1] ? 'green' : 'red'}" [icon]="row.phase[1] ? 'checkmark-square-2-outline' : 'close-square-outline'">
              </nb-icon>
            </ng-template>  
          </ngx-datatable-column>
          
          <ngx-datatable-column [name]="'E'" width="30" >
            <ng-template let-row="row" ngx-datatable-cell-template>
              <nb-icon [ngStyle]="{'color': row.phase[2] ? 'green' : 'red'}" [icon]="row.phase[2] ? 'checkmark-square-2-outline' : 'close-square-outline'">
              </nb-icon>
            </ng-template>  
          </ngx-datatable-column>
          
          <ngx-datatable-column [name]="'F'" width="30" >
            <ng-template let-row="row" ngx-datatable-cell-template>
              <nb-icon [ngStyle]="{'color': row.phase[3] ? 'green' : 'red'}" [icon]="row.phase[3] ? 'checkmark-square-2-outline' : 'close-square-outline'">
              </nb-icon>
            </ng-template>  
          </ngx-datatable-column>

          <ngx-datatable-column [name]="'Start Date'" prop="off_hire_start">
            <ng-template let-row="row" ngx-datatable-cell-template>
              {{ row.created_at | date:'medium' }}
            </ng-template> 
          </ngx-datatable-column>

          <ngx-datatable-column [name]="'Last Change'" prop="updated_at">
            <ng-template let-row="row" ngx-datatable-cell-template>
              {{ row.updated_at | date:'medium' }}
            </ng-template> 
          </ngx-datatable-column>

          <ngx-datatable-column [name]="''" width="50">
            <ng-template let-row="row" ngx-datatable-cell-template let-rowIndex="rowIndex">
              <!-- <button nbButton size="small" ghost (click)="deleteProject(row)"
              nbPopover="Delete Project" nbPopoverTrigger="hover" nbPopoverPlacement="top">
                <nb-icon icon="trash-2-outline" status="danger"></nb-icon>
              </button> -->
            </ng-template>
          </ngx-datatable-column>

        </ngx-datatable>
      </nb-card-body>
    </nb-card>
    