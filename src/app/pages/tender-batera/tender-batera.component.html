<nb-card class="p-3">  
  <div class="row">
    <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
          <div>
            <span class="d-block label">Project Name</span>  
            <nb-select placeholder="Project Name" size="small" fullWidth class="w-100" #projectName (ngModel)="projectName" name="id_proyek" class="m-1">
              <nb-option *ngFor="let value of projectData; let id=index;" [value]="projectData[id]" (click)="getProject(id)" #projectNameVal>{{value.shipName}}</nb-option>
            </nb-select>
            <span class="d-block label">Yard Name</span>
            <nb-select [placeholder]="selectedYard?.nama_galangan || 'Select Yard'" size="small" fullWidth class="w-100" [disabled]="!projectId || selectedText == 'Unselect'" #selectYard class="m-1">
              <nb-option *ngFor="let value of tenderData; let id=index;" [value]="tenderData[id]" (click)="getYard(id)">{{value.nama_galangan}}</nb-option>
            </nb-select>
            <span class="d-block label">Yard Location</span> 
            <span class="d-block text-capitalize">{{displayTender?.lokasi_galangan || 'Data not available'}}</span>
            <span class="d-block label">Responsible</span>
            <span class="d-block text-capitalize">{{displayTender?.responsible || 'Data not available'}}</span>
            <span class="d-block label">Contract Number</span> 
            <span class="d-block text-capitalize">{{displayTender?.no_kontrak || 'Data not available'}}</span>
            <span class="d-block label">Yard Quote</span> 
            <span class="d-block text-capitalize">{{displayTender?.yard_total_quote || 'Data not available'}}</span>
            <span class="d-block label">Comment</span>
            <p class="d-block">{{displayTender?.komentar || 'Data not available'}}</p>
          </div>
        </div>
    <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">

      <div class="my-2">
        <button nbButton size="tiny" class="mx-1" status="warning"  (click)="chooseTender()" outline [disabled]="!displayTender">{{selectedText}} Yard</button>
        <button nbButton size="tiny" class="mx-1" status="primary"  (click)="updateContractDial()" [disabled]="!displayTender">Update Yard</button>
        <button nbButton size="tiny" class="mx-1" status="danger"  (click)="deleteYard()" outline [disabled]="!displayTender">Delete Yard</button>
        <button nbButton size="tiny" class="mx-1" status="primary"  (click)="addContractDial()">Add Yard</button>
      </div>

      <nb-card class="p-3" *ngIf=" selectedYard ">
          <div *ngFor="let item of objectKeys(dataTable)">
            <div *ngIf="item != 'General Discount'&& item !='Additional Discount' else discount " class="row" >
              <div class="col-6"><strong>{{item}}</strong></div>
              <div class="">:</div>
              <div class="col text-capitalize text-right">{{dataTable?.[item]}}</div>
            </div>
            <ng-template #discount>
              <div class="row">
                <strong class="col-6">{{item}} </strong>
                <div class="">:</div>
                <div class="col text-right">({{dataTable?.[item].discount}} %) {{dataTable?.[item].after}}  </div>
              </div>
            </ng-template>
          </div>
          <!-- <div class="text-center mt-3">
            <button nbButton class="mx-1" status="primary" outline size="small">Preview</button>
          </div> -->
      </nb-card>
    </div>
  </div>
</nb-card>

<nb-accordion>
  <nb-accordion-item>
    <nb-accordion-item-header >Load Details</nb-accordion-item-header>
    <nb-accordion-item-body>
      <!-- <button nbButton class="m-1" status="primary" outline type="button" size="small" (click)="triggerSelectFile(addFromFile)">
        Add From File
      <input type="file" style="display: none;" #addFromFile>
      </button> -->
      <div style="overflow: auto; width: 100%;">
        <div style="width: 1524px;">
          <table [nbTreeGrid]="dataSource" [nbSort]="dataSource" equalColumnsWidth>
            <tr nbTreeGridHeaderRow *nbTreeGridHeaderRowDef="allColumns" [clickToToggle]="false"></tr>
            <tr nbTreeGridRow *nbTreeGridRowDef="let row; columns: allColumns" [clickToToggle]="false"></tr>
            <ng-container [nbTreeGridColumnDef]="'jobNumber'">
              <th nbTreeGridHeaderCell  *nbTreeGridHeaderCellDef style="width: 90px">Job No.</th>
              <td nbTreeGridCell *nbTreeGridCellDef="let row" >
                <nb-tree-grid-row-toggle [expanded]="row.expanded" *ngIf="row.data.kind === 'dir'; else fileIcon">
                </nb-tree-grid-row-toggle>
                <ng-template #fileIcon>
                  <nb-icon icon="file-text-outline"></nb-icon>
                </ng-template>
                {{row.data.jobNumber}}
              </td>
            </ng-container>
            <ng-container [nbTreeGridColumnDef]="'rank'">
              <th nbTreeGridHeaderCell  *nbTreeGridHeaderCellDef style="width: 50px"></th>
              <td nbTreeGridCell *nbTreeGridCellDef="let row" >
                <nb-icon icon="alert-circle-outline" [ngStyle]="{'color' : FNCOL.rankColor(row.data?.rank?.name)}"></nb-icon>
              </td>
            </ng-container>
            <ng-container [nbTreeGridColumnDef]="'Approve'">
              <th nbTreeGridHeaderCell *nbTreeGridHeaderCellDef style="width: 150px">
                <div class="text-center">
                  <nb-select placeholder="Approval" size="tiny" fullWidth class="w-100" #approval (ngModel)="approval" name="approvalStatus" class="m-1">
                    <nb-option *ngFor="let value of approvalStatus; let id=index;" [value]="approvalStatus[id]" (click)="approveStatus(id)">{{value}}</nb-option>
                  </nb-select>
                </div>
              </th>
              <td nbTreeGridCell *nbTreeGridCellDef="let row" class="text-center">
                <button class="text-center" nbButton ghost (click)="approvedByYard([row.data])">
                  <nb-icon [ngStyle]="{'color': row.data?.tenderApproval ? 'green' : 'grey'}" [icon]="row.data?.tenderApproval ?  'checkmark-square-2-outline' : 'square-outline'" status="primary"></nb-icon>
                </button>
              </td>
            </ng-container>

            <ng-container [nbTreeGridColumnDef]="'Edit'">
                <th nbTreeGridHeaderCell *nbTreeGridHeaderCellDef style="width: 80px"></th>
                <td nbTreeGridCell *nbTreeGridCellDef="let row" class="text-center">
                  <button class="btn btn-light btn-sm text-center" nbButton ghost (click)="editLoadDetails(row)">
                      <nb-icon icon="edit-outline" status="primary"></nb-icon>
                  </button>
                </td>
            </ng-container>

            <ng-container [nbTreeGridColumnDef]="'Resp'">
              <th nbTreeGridHeaderCell *nbTreeGridHeaderCellDef style="width: 80px">Resp</th>
              <td nbTreeGridCell *nbTreeGridCellDef="let row" class="text-center">{{row.data?.responsible?.name}}
              </td>
          </ng-container>

            <ng-container *ngFor="let column of defaultColumns; let index = index"
                          [nbTreeGridColumnDef]="column"
                          [showOn]="getShowOn(index)">
                <th nbTreeGridHeaderCell *nbTreeGridHeaderCellDef style="width: 150px">{{headColumns[index]}}</th>
                <td nbTreeGridCell *nbTreeGridCellDef="let row">{{row.data[column] || '-'}}</td>
            </ng-container>
          </table>
        </div>
      </div>
    </nb-accordion-item-body>
  </nb-accordion-item>
</nb-accordion>