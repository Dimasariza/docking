<div class="mx-5" *ngIf="tableDetails.searchBar">
  <label class="search-label" for="search">Search : </label>
  <input nbInput autocomplete="off" fieldSize="small" [nbFilterInput]="dataSource" id="search" class="search-input m-4">
</div>

<div style="overflow: auto; width: 100%;">
  <div [style]="tableDetails.style" class="m-2">
    <table [nbTreeGrid]="dataSource" [nbSort]="dataSource" (sort)="updateSort($event)" >
      <tr nbTreeGridHeaderRow *nbTreeGridHeaderRowDef="allColumns"></tr>
      <tr nbTreeGridRow *nbTreeGridRowDef="let row; columns: allColumns" [clickToToggle]="false"></tr>

      <ng-container *ngFor="let column of allColumns; let index = index;"
                    [nbTreeGridColumnDef]="column"
                    [showOn]="getShowOn(index)">
        <th nbTreeGridHeaderCell [nbSortHeader]="getSortDirection(column)" [style.width.px]="columnType[index].width"
        [disabled] = " tableHead[index].type === 'drop-down' " *nbTreeGridHeaderCellDef>
          <!-- Text only -->
          <span *ngIf=" tableHead[index].type === 'text' ">{{tableHead[index].placeholder}}</span>

          <!-- Drop Down -->
          <div  *ngIf=" tableHead[index].type === 'drop-down' " class="d-flex w-100">
            <span class="mr-3">{{ tableHead[index].placeholder }}</span>
            <nb-select [style.width.px]="columnType[index].width" [selected]="tableHead[index].option[0]" [compareWith]="compareById" size="small" fullWidth>
              <nb-option *ngFor="let item of tableHead[index].option" [value]="item" 
              (click)="handleClickOption(tableHead[index].target, item, column)"
              >
                {{item}}
              </nb-option>
            </nb-select>
          </div>
        </th>

        <td nbTreeGridCell *nbTreeGridCellDef="let row">
          <!-- Drop down Type -->
          <nb-select [selected]="columnType[index].option[0]" [compareWith]="compareById" placeholder="test plaec"
            *ngIf=" columnType[index].type === 'drop-down' " size="small">
            <nb-option *ngFor="let item of [1,2,4]" [value]="item">{{item}}</nb-option>
          </nb-select>

          <!-- Number Type -->
          <div *ngIf=" columnType[index].type == 'number' ">
            <nb-tree-grid-row-toggle [expanded]="row.expanded" *ngIf="row.data.kind == 'upper'"></nb-tree-grid-row-toggle>
            <nb-icon icon="minus-circle" pack="eva" style="font-size: '0.5rem';" *ngIf="row.data.kind == 'end'"></nb-icon>  
            {{row.data[column]}}
          </div>
          
          <!-- Icon type -->
          <nb-icon 
            *ngIf="columnType[index].type == 'icon'"
            class="flip-icon" 
            icon="chevron-right-outline" 
            pack="eva" 
          ></nb-icon> 

          <!-- Button type -->
          <button 
            nbButton 
            size="small" 
            class="btn-sm text-center" 
            outline 
            nbPopover="Delete Job" 
            nbPopoverTrigger="hint" 
            nbPopoverPlacement="top"
            *ngIf="columnType[index].type == 'button'"
          >
            <nb-icon icon="trash-outline" status="danger"></nb-icon>
          </button>

          <!-- Text Only -->
          <span *ngIf="columnType[index].type == 'text'">{{row.data[column] || '-'}}</span>

          <!-- Date -->
          <span *ngIf="columnType[index].type == 'date'">
            <span *ngIf="row.data[column]">{{row.data[column] | date: 'medium'}}</span>
            <span *ngIf="!row.data[column]"> - </span>
          </span>

          <!-- Currency -->
          <span *ngIf="columnType[index].type == 'currency'">{{row.data[column] || '-'}}</span>
        </td>
      </ng-container>
    </table>
  </div>
</div>

  
